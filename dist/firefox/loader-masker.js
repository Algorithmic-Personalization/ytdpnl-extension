(()=>{"use strict";var e=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,l=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=l.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return a},t=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,l=t.length;r<l;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},n=function(){return"1"===localStorage.getItem("debug")},o=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];n()&&("error"!==o[0]?console.log.apply(console,t([],e(o),!1)):console.error.apply(console,t([],e(o.slice(1)),!1)))},r=(function(){if(navigator.userAgent.includes("Chrome"));}(),"ytdpnl-loader-mask"),l=function(e,t,n,o){return new(n||(n=Promise))((function(r,l){function a(e){try{c(o.next(e))}catch(e){l(e)}}function i(e){try{c(o.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((o=o.apply(e,t||[])).next())}))},a=function(e,t){var n,o,r,l,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,i[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};l(void 0,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return"/"!==window.location.pathname?[3,2]:(o("installing loader mask because on home page"),[4,l(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,new Promise((function(e){var t=function(){return Boolean(document.body)};if(t())e();else{var n=new MutationObserver((function(){t()&&(n.disconnect(),e())}));n.observe(document.documentElement,{childList:!0,subtree:!0})}}))]}))}))]);case 1:return e.sent(),function(){var e,t=document.createElement("div");if(t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="white",t.style.zIndex="100000",t.id=r,n()){t.style.opacity=null!==(e=localStorage.getItem("opacity"))&&void 0!==e?e:"1";var o=document.createElement("button");o.type="button",o.style.margin="42px",o.textContent="Remove loader mask (this is only visible in debug mode)",o.addEventListener("click",(function(e){e.preventDefault(),t.remove()})),t.appendChild(o);var l=document.createElement("p");l.style.display="block",l.style.margin="42px",l.style.border="1px solid #ccc",l.style.backgroundColor="white",l.style.padding="12px",l.style.width="fit-content",l.style.fontWeight="bold",l.style.fontSize="20px",l.textContent='You can reduce the opacity of the mask by setting the variable "opacity" in localStorage. The value should be a number between 0 and 1.',t.appendChild(l)}document.body.appendChild(t)}(),[3,3];case 2:o("not installing loader mask because not on home page"),e.label=3;case 3:return[2]}}))})).catch((function(e){o("error","failed to start loader:",e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9hZGVyLW1hc2tlci5qcyIsIm1hcHBpbmdzIjoibWZBa0JhQSxFQUFVLFdBQU0sTUFBMkMsTUFBbENDLGFBQWFDLFFBQVEsUUFBOUIsRUFFaEJDLEVBQU0sVyxJQUFDLHNEQUNkSCxNQUlXLFVBQVpJLEVBQUssR0FLVEMsUUFBUUYsSUFBRyxNQUFYRSxRQUFPLE9BQVFELElBQUksSUFKbEJDLFFBQVFDLE1BQUssTUFBYkQsUUFBTyxPQUFVRCxFQUFLRyxNQUFNLEtBQUUsSUFLaEMsRUFpYWFDLEdBbkxhLFdBQ3pCLEdBSDZCQyxVQUFVQyxVQUFVQyxTQUFTLFdBZ0QzRCxDQUUyQkMsR0FtSUgsc0IsazJDQzdYVixtQyx3REQzRGlELE1BQTdCQyxPQUFPQyxTQUFTQyxTQzREN0MsT0FDSFosRUFBSSwrQ0FDSixHQWxFa0IsbUMsMkJBQVksYUFBSWEsU0FBYyxTQUFBQyxHQUNqRCxJQUFNQyxFQUFZLFdBQU0sT0FIR0MsUUFBUUMsU0FBU0MsS0FHcEIsRUFFeEIsR0FBSUgsSUFDSEQsUUFERCxDQUtBLElBQU1LLEVBQVcsSUFBSUMsa0JBQWlCLFdBQ2pDTCxNQUNISSxFQUFTRSxhQUNUUCxJQUVGLElBRUFLLEVBQVNHLFFBQVFMLFNBQVNNLGdCQUFpQixDQUFDQyxXQUFXLEVBQU1DLFNBQVMsRyxDQUN2RSxJLHVCQWtERSxTQWhEb0IsVyxNQUNmQyxFQUFhVCxTQUFTVSxjQUFjLE9BVTFDLEdBVEFELEVBQVdFLE1BQU1DLFNBQVcsUUFDNUJILEVBQVdFLE1BQU1FLElBQU0sSUFDdkJKLEVBQVdFLE1BQU1HLEtBQU8sSUFDeEJMLEVBQVdFLE1BQU1JLE1BQVEsT0FDekJOLEVBQVdFLE1BQU1LLE9BQVMsT0FDMUJQLEVBQVdFLE1BQU1NLGdCQUFrQixRQUNuQ1IsRUFBV0UsTUFBTU8sT0FBUyxTQUMxQlQsRUFBV1UsR0FBSy9CLEVBRVpSLElBQVcsQ0FDZDZCLEVBQVdFLE1BQU1TLFFBQXlDLFFBQS9CLEVBQUF2QyxhQUFhQyxRQUFRLGtCQUFVLFFBQUksSUFDOUQsSUFBTXVDLEVBQWdCckIsU0FBU1UsY0FBYyxVQUM3Q1csRUFBY0MsS0FBTyxTQUNyQkQsRUFBY1YsTUFBTVksT0FBUyxPQUM3QkYsRUFBY0csWUFBYywwREFDNUJILEVBQWNJLGlCQUFpQixTQUFTLFNBQUFDLEdBQ3ZDQSxFQUFFQyxpQkFDRmxCLEVBQVdtQixRQUNaLElBQ0FuQixFQUFXb0IsWUFBWVIsR0FFdkIsSUFBTVMsRUFBVzlCLFNBQVNVLGNBQWMsS0FDeENvQixFQUFTbkIsTUFBTW9CLFFBQVUsUUFDekJELEVBQVNuQixNQUFNWSxPQUFTLE9BQ3hCTyxFQUFTbkIsTUFBTXFCLE9BQVMsaUJBQ3hCRixFQUFTbkIsTUFBTU0sZ0JBQWtCLFFBQ2pDYSxFQUFTbkIsTUFBTXNCLFFBQVUsT0FDekJILEVBQVNuQixNQUFNSSxNQUFRLGNBQ3ZCZSxFQUFTbkIsTUFBTXVCLFdBQWEsT0FDNUJKLEVBQVNuQixNQUFNd0IsU0FBVyxPQUMxQkwsRUFBU04sWUFBYywwSUFDdkJmLEVBQVdvQixZQUFZQyxFLENBU3hCOUIsU0FBU0MsS0FBSzRCLFlBQVlwQixFQUMzQixDQU1FMkIsRyxhQUVBckQsRUFBSSx1RCxrQ0FJTyxPQUFDLFNBQUEyQyxHQUNiM0MsRUFBSSxRQUFTLDBCQUEyQjJDLEVBQ3pDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly95dGRwbmwvLi9zcmMvbGliLnRzIiwid2VicGFjazovL3l0ZHBubC8uL3NyYy9sb2FkZXItbWFza2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIFJlY29tbWVuZGF0aW9uIGZyb20gJy4vY29tbW9uL3R5cGVzL1JlY29tbWVuZGF0aW9uJztcbmltcG9ydCB7dHlwZSBSZWNvbW1lbmRhdGlvbkJhc2V9IGZyb20gJy4vY29tbW9uL3R5cGVzL1JlY29tbWVuZGF0aW9uJztcbmltcG9ydCB7Z2V0fSBmcm9tICcuL2NvbW1vbi91dGlsJztcblxuZXhwb3J0IGNvbnN0IGlzT25WaWRlb1BhZ2UgPSAoKSA9PiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvd2F0Y2gnO1xuZXhwb3J0IGNvbnN0IGlzVmlkZW9QYWdlID0gKHVybD86IHN0cmluZyk6IHVybCBpcyBzdHJpbmcgPT4gQm9vbGVhbihcblx0dXJsICYmIG5ldyBVUkwodXJsKS5wYXRobmFtZS5zdGFydHNXaXRoKCcvd2F0Y2gnKSxcbik7XG5leHBvcnQgY29uc3QgaXNPbkhvbWVQYWdlID0gKCkgPT4gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnLyc7XG5leHBvcnQgY29uc3QgaXNIb21lUGFnZSA9ICh1cmw6IHN0cmluZykgPT4ge1xuXHR0cnkge1xuXHRcdHJldHVybiBuZXcgVVJMKHVybCkucGF0aG5hbWUgPT09ICcvJztcblx0fSBjYXRjaCB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5leHBvcnQgY29uc3QgZGVidWcgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JztcbmV4cG9ydCBjb25zdCBpc0RlYnVnID0gKCkgPT4gZGVidWcgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RlYnVnJykgPT09ICcxJztcblxuZXhwb3J0IGNvbnN0IGxvZyA9ICguLi5hcmdzOiBhbnlbXSkgPT4ge1xuXHRpZiAoIWlzRGVidWcoKSkge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGlmIChhcmdzWzBdID09PSAnZXJyb3InKSB7XG5cdFx0Y29uc29sZS5lcnJvciguLi5hcmdzLnNsaWNlKDEpKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zb2xlLmxvZyguLi5hcmdzKTtcbn07XG5cbmV4cG9ydCBjb25zdCBleHRyYWN0WXRJbml0aWFsRGF0YSA9IChyYXdQYWdlSHRtbDogc3RyaW5nKSA9PiB7XG5cdGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblx0Y29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhyYXdQYWdlSHRtbCwgJ3RleHQvaHRtbCcpO1xuXHRjb25zdCBzY3JpcHRzID0gQXJyYXkuZnJvbShkb2MucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0JykpO1xuXG5cdHJldHVybiBzY3JpcHRzLmZpbmQoc2NyaXB0ID0+IHtcblx0XHRjb25zdCB7dGV4dENvbnRlbnR9ID0gc2NyaXB0O1xuXG5cdFx0aWYgKHRleHRDb250ZW50KSB7XG5cdFx0XHRyZXR1cm4gdGV4dENvbnRlbnQudHJpbVN0YXJ0KCkuc3RhcnRzV2l0aCgndmFyIHl0SW5pdGlhbERhdGEgPSAnKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0pO1xufTtcblxuZXhwb3J0IHR5cGUgVHJlZUNhbGxiYWNrID0gKG5vZGU6IHVua25vd24sIHBhdGg6IHN0cmluZ1tdLCBmdWxsT2JqZWN0PzogdW5rbm93bikgPT4gJ3JlY3Vyc2UnIHwgJ3N0b3AnO1xuXG5leHBvcnQgY29uc3Qgd2Fsa1RyZWUgPSAoY2I6IFRyZWVDYWxsYmFjaykgPT4gKG5vZGU6IHVua25vd24pID0+IHtcblx0Y29uc3Qgd2FsayA9IChub2RlOiB1bmtub3duLCBwYXRoOiBzdHJpbmdbXSwgZnVsbE9iamVjdDogdW5rbm93bikgPT4ge1xuXHRcdGNvbnN0IGFuZFRoZW4gPSBjYihub2RlLCBwYXRoLCBmdWxsT2JqZWN0KTtcblxuXHRcdGlmIChhbmRUaGVuID09PSAnc3RvcCcpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAobm9kZSA9PT0gbnVsbCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmIChBcnJheS5pc0FycmF5KG5vZGUpKSB7XG5cdFx0XHRmb3IgKGNvbnN0IFtpbmRleCwgdmFsdWVdIG9mIG5vZGUuZW50cmllcygpKSB7XG5cdFx0XHRcdHdhbGsodmFsdWUsIFsuLi5wYXRoLCBpbmRleC50b1N0cmluZygpXSwgZnVsbE9iamVjdCk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIG5vZGUgPT09ICdvYmplY3QnKSB7XG5cdFx0XHRmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhub2RlKSkge1xuXHRcdFx0XHR3YWxrKHZhbHVlLCBbLi4ucGF0aCwga2V5XSwgZnVsbE9iamVjdCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdHdhbGsobm9kZSwgW10sIG5vZGUpO1xufTtcblxuZXhwb3J0IHR5cGUgQ2hhbm5lbFJlY29tbWVuZGF0aW9uID0ge1xuXHR0aXRsZTogc3RyaW5nO1xuXHRwYXRoOiBzdHJpbmdbXTtcblx0cmVjb21tZW5kYXRpb246IFJlY29tbWVuZGF0aW9uO1xuXHRyYXdOb2RlOiB1bmtub3duO1xufTtcblxuY29uc3QgZ2V0TWluaWF0dXJlVXJsID0gKG5vZGU6IHVua25vd24pID0+IHtcblx0aWYgKHR5cGVvZiBub2RlICE9PSAnb2JqZWN0JyB8fCBub2RlID09PSBudWxsKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIG5vZGUnKTtcblx0fVxuXG5cdGNvbnN0IHZpZGVvSWQgPSBnZXQoWyd2aWRlb0lkJ10pKG5vZGUpIGFzIHN0cmluZztcblxuXHRjb25zdCBkZWZhdWx0VXJsID0gYGh0dHBzOi8vaS55dGltZy5jb20vdmkvJHt2aWRlb0lkfS9ocWRlZmF1bHQuanBnYDtcblxuXHRjb25zdCB0aHVtYm5haWxzID0gZ2V0KFsndGh1bWJuYWlsJywgJ3RodW1ibmFpbHMnXSkobm9kZSkgYXMgQXJyYXk8e3VybDogc3RyaW5nOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlcn0+O1xuXG5cdGlmICghdGh1bWJuYWlscykge1xuXHRcdHJldHVybiBkZWZhdWx0VXJsO1xuXHR9XG5cblx0Y29uc3Qgc29ydGVkVGh1bWJuYWlscyA9IHRodW1ibmFpbHMuc29ydCgoYSwgYikgPT4gKGIud2lkdGggKiBiLmhlaWdodCkgLSAoYS53aWR0aCAqIGEuaGVpZ2h0KSk7XG5cblx0cmV0dXJuIHNvcnRlZFRodW1ibmFpbHNbMF0udXJsO1xufTtcblxuZXhwb3J0IGNvbnN0IGV4dHJhY3RSZWNvbW1lbmRhdGlvbnMgPSAoXG5cdGluaXRpYWxEYXRhOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbik6IENoYW5uZWxSZWNvbW1lbmRhdGlvbltdID0+IHtcblx0Y29uc3QgcmVjb21tZW5kYXRpb25zOiBDaGFubmVsUmVjb21tZW5kYXRpb25bXSA9IFtdO1xuXG5cdGNvbnN0IGNiOiBUcmVlQ2FsbGJhY2sgPSAobm9kZSwgcGF0aCwgZnVsbE9iamVjdCkgPT4ge1xuXHRcdGlmIChwYXRoLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0cmV0dXJuICdyZWN1cnNlJztcblx0XHR9XG5cblx0XHRjb25zdCBnZXRUaXRsZSA9ICgpID0+IHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHJldHVybiBnZXQoWyd0aXRsZScsICdydW5zJywgJzAnLCAndGV4dCddKShub2RlKSBhcyBzdHJpbmc7XG5cdFx0XHR9IGNhdGNoIHtcblx0XHRcdFx0cmV0dXJuIGdldChbJ3RpdGxlJywgJ3NpbXBsZVRleHQnXSkobm9kZSkgYXMgc3RyaW5nO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRjb25zdCBsYXN0S2V5ID0gcGF0aFtwYXRoLmxlbmd0aCAtIDFdO1xuXG5cdFx0aWYgKGxhc3RLZXkgPT09ICd2aWRlb1JlbmRlcmVyJykge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgdGl0bGUgPSBnZXRUaXRsZSgpO1xuXG5cdFx0XHRcdGNvbnN0IHZpZGVvSWQgPSBnZXQoWyd2aWRlb0lkJ10pKG5vZGUpIGFzIHN0cmluZztcblxuXHRcdFx0XHRjb25zdCBjaGFubmVsTWluaWF0dXJlVXJsID0gZ2V0KFtcblx0XHRcdFx0XHQnY2hhbm5lbFRodW1ibmFpbFN1cHBvcnRlZFJlbmRlcmVycycsXG5cdFx0XHRcdFx0J2NoYW5uZWxUaHVtYm5haWxXaXRoTGlua1JlbmRlcmVyJyxcblx0XHRcdFx0XHQndGh1bWJuYWlsJyxcblx0XHRcdFx0XHQndGh1bWJuYWlscycsXG5cdFx0XHRcdFx0JzAnLFxuXHRcdFx0XHRcdCd1cmwnLFxuXHRcdFx0XHRdKShub2RlKSBhcyBzdHJpbmc7XG5cblx0XHRcdFx0Y29uc3QgY2hhbm5lbFNob3J0TmFtZSA9IGdldChbXG5cdFx0XHRcdFx0J293bmVyVGV4dCcsXG5cdFx0XHRcdFx0J3J1bnMnLFxuXHRcdFx0XHRcdCcwJyxcblx0XHRcdFx0XHQnbmF2aWdhdGlvbkVuZHBvaW50Jyxcblx0XHRcdFx0XHQnYnJvd3NlRW5kcG9pbnQnLFxuXHRcdFx0XHRcdCdjYW5vbmljYWxCYXNlVXJsJyxcblx0XHRcdFx0XSkobm9kZSkgYXMgc3RyaW5nO1xuXG5cdFx0XHRcdGNvbnN0IGdldEhvdmVyQW5pbWF0aW9uVXJsID0gKCkgPT4ge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZ2V0KFtcblx0XHRcdFx0XHRcdFx0J3JpY2hUaHVtYm5haWwnLFxuXHRcdFx0XHRcdFx0XHQnbW92aW5nVGh1bWJuYWlsUmVuZGVyZXInLFxuXHRcdFx0XHRcdFx0XHQnbW92aW5nVGh1bWJuYWlsRGV0YWlscycsXG5cdFx0XHRcdFx0XHRcdCd0aHVtYm5haWxzJyxcblx0XHRcdFx0XHRcdFx0JzAnLFxuXHRcdFx0XHRcdFx0XHQndXJsJyxcblx0XHRcdFx0XHRcdF0pKG5vZGUpIGFzIHN0cmluZztcblx0XHRcdFx0XHR9IGNhdGNoIHtcblx0XHRcdFx0XHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdGNvbnN0IG1pbmlhdHVyZVVybCA9IGdldE1pbmlhdHVyZVVybChub2RlKTtcblxuXHRcdFx0XHRjb25zdCByZWNvbW1lbmRhdGlvbjogUmVjb21tZW5kYXRpb24gPSB7XG5cdFx0XHRcdFx0dmlkZW9JZCxcblx0XHRcdFx0XHR0aXRsZSxcblx0XHRcdFx0XHR1cmw6IGBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PSR7dmlkZW9JZH1gLFxuXHRcdFx0XHRcdGNoYW5uZWxOYW1lOiBnZXQoWydsb25nQnlsaW5lVGV4dCcsICdydW5zJywgJzAnLCAndGV4dCddKShub2RlKSBhcyBzdHJpbmcsXG5cdFx0XHRcdFx0dmlld3M6IGdldChbJ3Nob3J0Vmlld0NvdW50VGV4dCcsICdzaW1wbGVUZXh0J10pKG5vZGUpIGFzIHN0cmluZyxcblx0XHRcdFx0XHRwdWJsaXNoZWRTaW5jZTogZ2V0KFsncHVibGlzaGVkVGltZVRleHQnLCAnc2ltcGxlVGV4dCddKShub2RlKSBhcyBzdHJpbmcsXG5cdFx0XHRcdFx0bWluaWF0dXJlVXJsLFxuXHRcdFx0XHRcdHBlcnNvbmFsaXphdGlvbjogJ3BlcnNvbmFsaXplZCcsXG5cdFx0XHRcdFx0Y2hhbm5lbE1pbmlhdHVyZVVybCxcblx0XHRcdFx0XHRjaGFubmVsU2hvcnROYW1lLFxuXHRcdFx0XHRcdGhvdmVyQW5pbWF0aW9uVXJsOiBnZXRIb3ZlckFuaW1hdGlvblVybCgpLFxuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHR0aXRsZSxcblx0XHRcdFx0XHRwYXRoLFxuXHRcdFx0XHRcdHJlY29tbWVuZGF0aW9uLFxuXHRcdFx0XHRcdHJhd05vZGU6IG5vZGUsXG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJldHVybiAnc3RvcCc7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRsb2coJ2Vycm9yJywgJ3BhcnNpbmcgdmlkZW9SZW5kZXJlcicsIHtwYXRoLCBub2RlLCBlcnJvcn0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChsYXN0S2V5ID09PSAnZ3JpZFZpZGVvUmVuZGVyZXInKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCB2aWRlb0lkID0gZ2V0KFsndmlkZW9JZCddKShub2RlKSBhcyBzdHJpbmc7XG5cblx0XHRcdFx0Y29uc3QgdGl0bGUgPSBnZXRUaXRsZSgpO1xuXG5cdFx0XHRcdGNvbnN0IGNoYW5uZWxOYW1lID0gZ2V0KFtcblx0XHRcdFx0XHQnbWV0YWRhdGEnLFxuXHRcdFx0XHRcdCdjaGFubmVsTWV0YWRhdGFSZW5kZXJlcicsXG5cdFx0XHRcdFx0J3RpdGxlJyxcblx0XHRcdFx0XSkoZnVsbE9iamVjdCkgYXMgc3RyaW5nO1xuXG5cdFx0XHRcdGNvbnN0IGNoYW5uZWxWYW5pdHlVcmwgPSBnZXQoW1xuXHRcdFx0XHRcdCdtZXRhZGF0YScsXG5cdFx0XHRcdFx0J2NoYW5uZWxNZXRhZGF0YVJlbmRlcmVyJyxcblx0XHRcdFx0XHQndmFuaXR5Q2hhbm5lbFVybCcsXG5cdFx0XHRcdF0pKGZ1bGxPYmplY3QpIGFzIHN0cmluZztcblxuXHRcdFx0XHRjb25zdCBwYXJ0c09mQ2hhbmVsVXJsID0gY2hhbm5lbFZhbml0eVVybC5zcGxpdCgnLycpO1xuXG5cdFx0XHRcdGNvbnN0IGNoYW5uZWxTaG9ydE5hbWUgPSBwYXJ0c09mQ2hhbmVsVXJsW3BhcnRzT2ZDaGFuZWxVcmwubGVuZ3RoIC0gMV07XG5cblx0XHRcdFx0Y29uc3QgcmVjb21tZW5kYXRpb246IFJlY29tbWVuZGF0aW9uID0ge1xuXHRcdFx0XHRcdHRpdGxlLFxuXHRcdFx0XHRcdHVybDogYGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9JHt2aWRlb0lkfWAsXG5cdFx0XHRcdFx0dmlkZW9JZCxcblx0XHRcdFx0XHRtaW5pYXR1cmVVcmw6IGdldE1pbmlhdHVyZVVybChub2RlKSxcblx0XHRcdFx0XHRjaGFubmVsTmFtZSxcblx0XHRcdFx0XHR2aWV3czogZ2V0KFsndmlld0NvdW50VGV4dCcsICdzaW1wbGVUZXh0J10pKG5vZGUpIGFzIHN0cmluZyxcblx0XHRcdFx0XHRwdWJsaXNoZWRTaW5jZTogZ2V0KFsncHVibGlzaGVkVGltZVRleHQnLCAnc2ltcGxlVGV4dCddKShub2RlKSBhcyBzdHJpbmcsXG5cdFx0XHRcdFx0cGVyc29uYWxpemF0aW9uOiAncGVyc29uYWxpemVkJyxcblx0XHRcdFx0XHRob3ZlckFuaW1hdGlvblVybDogZ2V0KFtcblx0XHRcdFx0XHRcdCdyaWNoVGh1bWJuYWlsJyxcblx0XHRcdFx0XHRcdCdtb3ZpbmdUaHVtYm5haWxSZW5kZXJlcicsXG5cdFx0XHRcdFx0XHQnbW92aW5nVGh1bWJuYWlsRGV0YWlscycsXG5cdFx0XHRcdFx0XHQndGh1bWJuYWlscycsXG5cdFx0XHRcdFx0XHQnMCcsXG5cdFx0XHRcdFx0XHQndXJsJyxcblx0XHRcdFx0XHRdKShub2RlKSBhcyBzdHJpbmcsXG5cdFx0XHRcdFx0Y2hhbm5lbE1pbmlhdHVyZVVybDogZ2V0KFtcblx0XHRcdFx0XHRcdCdtZXRhZGF0YScsXG5cdFx0XHRcdFx0XHQnY2hhbm5lbE1ldGFkYXRhUmVuZGVyZXInLFxuXHRcdFx0XHRcdFx0J2F2YXRhcicsXG5cdFx0XHRcdFx0XHQndGh1bWJuYWlscycsXG5cdFx0XHRcdFx0XHQnMCcsXG5cdFx0XHRcdFx0XHQndXJsJyxcblx0XHRcdFx0XHRdKShmdWxsT2JqZWN0KSBhcyBzdHJpbmcsXG5cdFx0XHRcdFx0Y2hhbm5lbFNob3J0TmFtZSxcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRyZWNvbW1lbmRhdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0dGl0bGU6IHJlY29tbWVuZGF0aW9uLnRpdGxlLFxuXHRcdFx0XHRcdHBhdGgsXG5cdFx0XHRcdFx0cmVjb21tZW5kYXRpb24sXG5cdFx0XHRcdFx0cmF3Tm9kZTogbm9kZSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRsb2coJ2Vycm9yJywgJ3BhcnNpbmcgZ3JpZFZpZGVvUmVuZGVyZXInLCB7cGF0aCwgbm9kZSwgZXJyb3J9KTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuICdzdG9wJztcblx0XHR9XG5cblx0XHRyZXR1cm4gJ3JlY3Vyc2UnO1xuXHR9O1xuXG5cdHdhbGtUcmVlKGNiKShpbml0aWFsRGF0YSk7XG5cblx0cmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbn07XG5cbmV4cG9ydCBjb25zdCBpc0Nocm9tZSA9ICgpID0+IG5hdmlnYXRvci51c2VyQWdlbnQuaW5jbHVkZXMoJ0Nocm9tZScpO1xuXG5jb25zdCBjcmVhdGVJbWFnZUV4aXN0cyA9ICgpOiAoKHVybDogc3RyaW5nKSA9PiBQcm9taXNlPGJvb2xlYW4+KSA9PiB7XG5cdGlmIChpc0Nocm9tZSgpKSB7XG5cdFx0cmV0dXJuIGFzeW5jIHVybCA9PiB7XG5cdFx0XHRjb25zdCByID0gYXdhaXQgZmV0Y2godXJsLCB7bWV0aG9kOiAnSEVBRCd9KTtcblx0XHRcdHJldHVybiByLm9rO1xuXHRcdH07XG5cdH1cblxuXHRjb25zdCB0aW1lb3V0ID0gNTAwMDtcblx0bGV0IGFzc3VtZUxvYWRlZCA9IGZhbHNlO1xuXG5cdHJldHVybiBhc3luYyB1cmwgPT4ge1xuXHRcdGlmIChhc3N1bWVMb2FkZWQpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRhc3N1bWVMb2FkZWQgPSB0cnVlO1xuXHRcdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaW1nKTtcblx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKCdUaW1lb3V0JykpO1xuXHRcdFx0XHR9LCB0aW1lb3V0KTtcblxuXHRcdFx0XHRjb25zdCBpbWcgPSBuZXcgSW1hZ2UoKTtcblx0XHRcdFx0aW1nLm9ubG9hZCA9ICgpID0+IHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGltZyk7XG5cdFx0XHRcdFx0cmVzb2x2ZSh0cnVlKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRpbWcub25lcnJvciA9ICgpID0+IHtcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGltZyk7XG5cdFx0XHRcdFx0cmVzb2x2ZShmYWxzZSk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0aW1nLnN0eWxlLndpZHRoID0gJzFweCc7XG5cdFx0XHRcdGltZy5zdHlsZS5oZWlnaHQgPSAnMXB4JztcblxuXHRcdFx0XHRpbWcuc3JjID0gdXJsO1xuXG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW1nKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG59O1xuXG5leHBvcnQgY29uc3QgaW1hZ2VFeGlzdHMgPSBjcmVhdGVJbWFnZUV4aXN0cygpO1xuXG5leHBvcnQgY29uc3QgaXNMb2dnZWRJbiA9ICgpID0+IEJvb2xlYW4oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2F2YXRhci1idG4nKSk7XG5cbmV4cG9ydCBjb25zdCBpc05vdExvZ2dlZEluID0gKCkgPT4gQm9vbGVhbihcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYVtocmVmXj1cImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9TZXJ2aWNlTG9naW4/c2VydmljZT15b3V0dWJlXCJdJyksXG4pO1xuXG5leHBvcnQgdHlwZSBSZXMgPSAneWVzJyB8ICdubycgfCAnbWF5YmUnO1xuXG5leHBvcnQgY29uc3QgaXNMb2dnZWRJbkZvclN1cmVZdCA9IGFzeW5jICgpOiBQcm9taXNlPFJlcz4gPT4ge1xuXHRjb25zdCBjaGVjayA9ICgpOiBSZXMgPT4ge1xuXHRcdGlmIChpc0xvZ2dlZEluKCkpIHtcblx0XHRcdHJldHVybiAneWVzJztcblx0XHR9XG5cblx0XHRpZiAoaXNOb3RMb2dnZWRJbigpKSB7XG5cdFx0XHRyZXR1cm4gJ25vJztcblx0XHR9XG5cblx0XHRyZXR1cm4gJ21heWJlJztcblx0fTtcblxuXHRyZXR1cm4gbmV3IFByb21pc2U8UmVzPihyZXNvbHZlID0+IHtcblx0XHRjb25zdCByZXMgPSBjaGVjaygpO1xuXG5cdFx0aWYgKHJlcyAhPT0gJ21heWJlJykge1xuXHRcdFx0cmVzb2x2ZShyZXMpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xuXHRcdFx0Y29uc3QgcmVzID0gY2hlY2soKTtcblxuXHRcdFx0aWYgKHJlcyAhPT0gJ21heWJlJykge1xuXHRcdFx0XHRvYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0XHRcdHJlc29sdmUocmVzKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCB7Y2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlfSk7XG5cdH0pO1xufTtcblxuY29uc3QgbmFtZXNwYWNlID0gJ3l0ZHBubC1leHRlbnNpb24tJztcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcbmV4cG9ydCBjb25zdCBnZXRGcm9tTG9jYWxTdG9yYWdlID0gKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCA9PiB7XG5cdGNvbnN0IG5ld0Zvcm1hdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKG5hbWVzcGFjZSArIGtleSk7XG5cblx0aWYgKG5ld0Zvcm1hdCkge1xuXHRcdHJldHVybiBuZXdGb3JtYXQ7XG5cdH1cblxuXHRjb25zdCBvbGRGb3JtYXQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuXG5cdGlmIChvbGRGb3JtYXQpIHtcblx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbShuYW1lc3BhY2UgKyBrZXksIG9sZEZvcm1hdCk7XG5cdFx0bG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcblxuXHRcdHJldHVybiBvbGRGb3JtYXQ7XG5cdH1cblxuXHRyZXR1cm4gbnVsbDtcbn07XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG5leHBvcnQgY29uc3QgZ2V0RnJvbVNlc3Npb25TdG9yYWdlID0gKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCA9PiB7XG5cdGNvbnN0IG5ld0Zvcm1hdCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0obmFtZXNwYWNlICsga2V5KTtcblxuXHRpZiAobmV3Rm9ybWF0KSB7XG5cdFx0cmV0dXJuIG5ld0Zvcm1hdDtcblx0fVxuXG5cdGNvbnN0IG9sZEZvcm1hdCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oa2V5KTtcblxuXHRpZiAob2xkRm9ybWF0KSB7XG5cdFx0c2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShuYW1lc3BhY2UgKyBrZXksIG9sZEZvcm1hdCk7XG5cdFx0c2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuXG5cdFx0cmV0dXJuIG9sZEZvcm1hdDtcblx0fVxuXG5cdHJldHVybiBudWxsO1xufTtcblxuZXhwb3J0IGNvbnN0IHNhdmVUb0xvY2FsU3RvcmFnZSA9IChrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZykgPT4ge1xuXHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuXHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbShuYW1lc3BhY2UgKyBrZXksIHZhbHVlKTtcbn07XG5cbmV4cG9ydCBjb25zdCBzYXZlVG9TZXNzaW9uU3RvcmFnZSA9IChrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZykgPT4ge1xuXHRzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG5cdHNlc3Npb25TdG9yYWdlLnNldEl0ZW0obmFtZXNwYWNlICsga2V5LCB2YWx1ZSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGVsZXRlRnJvbUxvY2FsU3RvcmFnZSA9IChrZXk6IHN0cmluZykgPT4ge1xuXHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuXHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShuYW1lc3BhY2UgKyBrZXkpO1xufTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUZyb21TZXNzaW9uU3RvcmFnZSA9IChrZXk6IHN0cmluZykgPT4ge1xuXHRzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG5cdHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0obmFtZXNwYWNlICsga2V5KTtcbn07XG5cbmV4cG9ydCBjb25zdCBjbGVhbkxvY2FsU3RvcmFnZSA9ICgpID0+IHtcblx0Y29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGxvY2FsU3RvcmFnZSk7XG5cblx0Zm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuXHRcdGlmIChrZXkuc3RhcnRzV2l0aChuYW1lc3BhY2UpKSB7XG5cdFx0XHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGNvbnN0IGNsZWFuU2Vzc2lvblN0b3JhZ2UgPSAoKSA9PiB7XG5cdGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhzZXNzaW9uU3RvcmFnZSk7XG5cblx0Zm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuXHRcdGlmIChrZXkuc3RhcnRzV2l0aChuYW1lc3BhY2UpKSB7XG5cdFx0XHRzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG5cdFx0fVxuXHR9XG59O1xuXG5leHBvcnQgY29uc3QgY2xlYW5TdG9yYWdlID0gKCkgPT4ge1xuXHRjbGVhbkxvY2FsU3RvcmFnZSgpO1xuXHRjbGVhblNlc3Npb25TdG9yYWdlKCk7XG59O1xuXG5leHBvcnQgY29uc3QgbG9hZGVySWQgPSAneXRkcG5sLWxvYWRlci1tYXNrJztcblxuZXhwb3J0IGNvbnN0IHJlbW92ZUxvYWRlck1hc2sgPSAoKSA9PiB7XG5cdGNvbnN0IG1hc2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsb2FkZXJJZCk7XG5cblx0aWYgKG1hc2spIHtcblx0XHQvLyBBZGQgYSB0aW55IHRpbWVvdXQgdG8gcmVkdWNlIGZsaWNrZXJpbmdcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdG1hc2sucmVtb3ZlKCk7XG5cdFx0fSwgMjAwKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHJldHVybiBmYWxzZTtcbn07XG5cbmV4cG9ydCBjb25zdCBmaW5kUGFyZW50QnlJZCA9IChlbElkOiBzdHJpbmcpID0+IChlbHQ6IEVsZW1lbnQpOiBFbGVtZW50IHwgdW5kZWZpbmVkID0+IHtcblx0Y29uc3QgcmVjdXJzZSA9IGZpbmRQYXJlbnRCeUlkKGVsSWQpO1xuXG5cdGlmIChlbHQuaWQgPT09IGVsSWQpIHtcblx0XHRyZXR1cm4gZWx0O1xuXHR9XG5cblx0aWYgKGVsdC5wYXJlbnRFbGVtZW50KSB7XG5cdFx0cmV0dXJuIHJlY3Vyc2UoZWx0LnBhcmVudEVsZW1lbnQpO1xuXHR9XG5cblx0cmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBjb25zdCBzbGVlcCA9IGFzeW5jIChtczogbnVtYmVyKSA9PiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcblx0c2V0VGltZW91dChyZXNvbHZlLCBtcyk7XG59KTtcblxuY29uc3QgZ2V0VmlkZW9UaXRsZSA9IChub2RlOiBIVE1MRWxlbWVudCk6IHN0cmluZyB8IHVuZGVmaW5lZCA9PiB7XG5cdGNvbnN0IG1heWJlVGl0bGUgPSBub2RlLnF1ZXJ5U2VsZWN0b3IoJyN2aWRlby10aXRsZScpO1xuXG5cdGlmIChtYXliZVRpdGxlKSB7XG5cdFx0cmV0dXJuIG1heWJlVGl0bGUudGV4dENvbnRlbnQ/LnRyaW0oKTtcblx0fVxuXG5cdGlmIChub2RlLnBhcmVudEVsZW1lbnQgJiYgbm9kZS5pZCAhPT0gJ2NvbnRlbnQnKSB7XG5cdFx0cmV0dXJuIGdldFZpZGVvVGl0bGUobm9kZS5wYXJlbnRFbGVtZW50KTtcblx0fVxuXG5cdHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5jb25zdCByZW1vdmVMZXR0ZXJzQWZ0ZXIgPSAoc3ViU3RyTmVlZGxlOiBzdHJpbmcpID0+IChzdHI6IHN0cmluZyk6IHN0cmluZyA9PiB7XG5cdGNvbnN0IGluZGV4ID0gc3RyLmluZGV4T2Yoc3ViU3RyTmVlZGxlKTtcblxuXHRpZiAoaW5kZXggPT09IC0xKSB7XG5cdFx0cmV0dXJuIHN0cjtcblx0fVxuXG5cdHJldHVybiBzdHIuc2xpY2UoMCwgaW5kZXgpO1xufTtcblxuY29uc3QgaXNMaW5rVG9WaWRlbyA9IChsaW5rOiBIVE1MQW5jaG9yRWxlbWVudCk6IHN0cmluZyB8IGZhbHNlID0+IHtcblx0Y29uc3QgbSA9IC9cXD92PSguKykkLy5leGVjKGxpbmsuaHJlZik7XG5cblx0aWYgKG0pIHtcblx0XHRyZXR1cm4gcmVtb3ZlTGV0dGVyc0FmdGVyKCcmJykobVsxXSk7XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG4vLyBMaW5rIHNlbGVjdG9yIGZvciBob21lOlxuY29uc3QgZG9HZXRSZWNvbW1lbmRhdGlvbkJhc2VzID0gKGxpbmtTZWxlY3Rvcjogc3RyaW5nKTogUmVjb21tZW5kYXRpb25CYXNlW10gPT4ge1xuXHRjb25zdCBsaW5rczogSFRNTEFuY2hvckVsZW1lbnRbXSA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChsaW5rU2VsZWN0b3IpKTtcblx0Y29uc3QgbWF5YmVSZXM6IEFycmF5PFJlY29tbWVuZGF0aW9uQmFzZSB8IHVuZGVmaW5lZD4gPSBsaW5rcy5tYXAobGluayA9PiB7XG5cdFx0Y29uc3QgbWF5YmVWaWRlb0lkID0gaXNMaW5rVG9WaWRlbyhsaW5rKTtcblxuXHRcdGlmIChtYXliZVZpZGVvSWQgPT09IGZhbHNlKSB7XG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdGNvbnN0IHZpZGVvSWQgPSBtYXliZVZpZGVvSWQ7XG5cblx0XHRjb25zdCB0aXRsZSA9IGdldFZpZGVvVGl0bGUobGluayk7XG5cblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHR2aWRlb0lkLFxuXHRcdFx0dGl0bGUsXG5cdFx0XHR1cmw6IGxpbmsuaHJlZixcblx0XHR9O1xuXHR9KTtcblxuXHRyZXR1cm4gbWF5YmVSZXMuZmlsdGVyKEJvb2xlYW4pIGFzIFJlY29tbWVuZGF0aW9uQmFzZVtdO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFJlY29tbWVuZGF0aW9uc09uUGFnZSA9IChsb2c6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCkgPT4gYXN5bmMgKGxpbmtTZWxlY3Rvcjogc3RyaW5nLCBtaW5pbXVtID0gMykgPT4ge1xuXHRsZXQgYXR0ZW1wdHMgPSAwO1xuXHRjb25zdCBkZWxheXMgPSBbMTAwMCwgMjAwMCwgMzAwMCwgNTAwMCwgODAwMCwgMTMwMDBdO1xuXHRjb25zdCBtYXhBdHRlbXB0cyA9IGRlbGF5cy5sZW5ndGg7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlPFJlY29tbWVuZGF0aW9uQmFzZVtdPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0Y29uc3QgZ2V0VmlkZW9zID0gKCkgPT4ge1xuXHRcdFx0Y29uc3QgdmlkZW9zID0gZG9HZXRSZWNvbW1lbmRhdGlvbkJhc2VzKGxpbmtTZWxlY3Rvcik7XG5cblx0XHRcdGlmICh2aWRlb3MubGVuZ3RoID49IG1pbmltdW0pIHtcblx0XHRcdFx0cmVzb2x2ZSh2aWRlb3MpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdCsrYXR0ZW1wdHM7XG5cdFx0XHRsb2coJ2Vycm9yJywgJ2ZhaWxlZCB0byBzY3JhcGUgdmlkZW9zIGZyb20gcGFnZSwgYXR0ZW1wdCcsIGF0dGVtcHRzLCAnb2YnLCBtYXhBdHRlbXB0cyk7XG5cblx0XHRcdGlmIChhdHRlbXB0cyA8IG1heEF0dGVtcHRzKSB7XG5cdFx0XHRcdGNvbnN0IGRlbGF5ID0gZGVsYXlzW2F0dGVtcHRzXTtcblx0XHRcdFx0bG9nKCd0cnlpbmcgYWdhaW4gaW4nLCBkZWxheSwgJ21zJyk7XG5cdFx0XHRcdHNldFRpbWVvdXQoZ2V0VmlkZW9zLCBkZWxheSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZWplY3QobmV3IEVycm9yKCdmYWlsZWQgdG8gZ2V0IGhvbWUgdmlkZW9zJykpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRnZXRWaWRlb3MoKTtcblx0fSk7XG59O1xuIiwiaW1wb3J0IHtpc0RlYnVnLCBpc09uSG9tZVBhZ2UsIGxvYWRlcklkLCBsb2d9IGZyb20gJy4vbGliJztcblxuY29uc3QgaXNCb2R5UHJlc2VudCA9ICgpID0+IEJvb2xlYW4oZG9jdW1lbnQuYm9keSk7XG5cbmNvbnN0IHdhaXRGb3JCb2R5ID0gYXN5bmMgKCkgPT4gbmV3IFByb21pc2U8dm9pZD4ocmVzb2x2ZSA9PiB7XG5cdGNvbnN0IGNvbmRpdGlvbiA9ICgpID0+IGlzQm9keVByZXNlbnQoKTtcblxuXHRpZiAoY29uZGl0aW9uKCkpIHtcblx0XHRyZXNvbHZlKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG5cdFx0aWYgKGNvbmRpdGlvbigpKSB7XG5cdFx0XHRvYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0XHRyZXNvbHZlKCk7XG5cdFx0fVxuXHR9KTtcblxuXHRvYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX0pO1xufSk7XG5cbmNvbnN0IGluc3RhbGxMb2FkZXIgPSAoKSA9PiB7XG5cdGNvbnN0IG1hc2tpbmdEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0bWFza2luZ0Rpdi5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XG5cdG1hc2tpbmdEaXYuc3R5bGUudG9wID0gJzAnO1xuXHRtYXNraW5nRGl2LnN0eWxlLmxlZnQgPSAnMCc7XG5cdG1hc2tpbmdEaXYuc3R5bGUud2lkdGggPSAnMTAwJSc7XG5cdG1hc2tpbmdEaXYuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xuXHRtYXNraW5nRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICd3aGl0ZSc7XG5cdG1hc2tpbmdEaXYuc3R5bGUuekluZGV4ID0gJzEwMDAwMCc7XG5cdG1hc2tpbmdEaXYuaWQgPSBsb2FkZXJJZDtcblxuXHRpZiAoaXNEZWJ1ZygpKSB7XG5cdFx0bWFza2luZ0Rpdi5zdHlsZS5vcGFjaXR5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ29wYWNpdHknKSA/PyAnMSc7XG5cdFx0Y29uc3QgcmVtb3ZlTWFza0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuXHRcdHJlbW92ZU1hc2tCdG4udHlwZSA9ICdidXR0b24nO1xuXHRcdHJlbW92ZU1hc2tCdG4uc3R5bGUubWFyZ2luID0gJzQycHgnO1xuXHRcdHJlbW92ZU1hc2tCdG4udGV4dENvbnRlbnQgPSAnUmVtb3ZlIGxvYWRlciBtYXNrICh0aGlzIGlzIG9ubHkgdmlzaWJsZSBpbiBkZWJ1ZyBtb2RlKSc7XG5cdFx0cmVtb3ZlTWFza0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0bWFza2luZ0Rpdi5yZW1vdmUoKTtcblx0XHR9KTtcblx0XHRtYXNraW5nRGl2LmFwcGVuZENoaWxkKHJlbW92ZU1hc2tCdG4pO1xuXG5cdFx0Y29uc3QgaGVscFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdFx0aGVscFRleHQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0aGVscFRleHQuc3R5bGUubWFyZ2luID0gJzQycHgnO1xuXHRcdGhlbHBUZXh0LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgI2NjYyc7XG5cdFx0aGVscFRleHQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3doaXRlJztcblx0XHRoZWxwVGV4dC5zdHlsZS5wYWRkaW5nID0gJzEycHgnO1xuXHRcdGhlbHBUZXh0LnN0eWxlLndpZHRoID0gJ2ZpdC1jb250ZW50Jztcblx0XHRoZWxwVGV4dC5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuXHRcdGhlbHBUZXh0LnN0eWxlLmZvbnRTaXplID0gJzIwcHgnO1xuXHRcdGhlbHBUZXh0LnRleHRDb250ZW50ID0gJ1lvdSBjYW4gcmVkdWNlIHRoZSBvcGFjaXR5IG9mIHRoZSBtYXNrIGJ5IHNldHRpbmcgdGhlIHZhcmlhYmxlIFwib3BhY2l0eVwiIGluIGxvY2FsU3RvcmFnZS4gVGhlIHZhbHVlIHNob3VsZCBiZSBhIG51bWJlciBiZXR3ZWVuIDAgYW5kIDEuJztcblx0XHRtYXNraW5nRGl2LmFwcGVuZENoaWxkKGhlbHBUZXh0KTtcblx0fVxuXG5cdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby13YXJuaW5nLWNvbW1lbnRzXG5cdC8qIFRPRE8gKG1heWJlKTpcblx0XHRXYXRjaCBmb3IgY2hhbmdlcyBvbiB0aGUgcGFnZSB0byBhZGQgYW5vdGhlciBtb3JlXG5cdFx0c2VsZWN0aXZlIGxvYWRlci5cblx0Ki9cblxuXHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1hc2tpbmdEaXYpO1xufTtcblxuY29uc3Qgc3RhcnQgPSBhc3luYyAoKSA9PiB7XG5cdGlmIChpc09uSG9tZVBhZ2UoKSkge1xuXHRcdGxvZygnaW5zdGFsbGluZyBsb2FkZXIgbWFzayBiZWNhdXNlIG9uIGhvbWUgcGFnZScpO1xuXHRcdGF3YWl0IHdhaXRGb3JCb2R5KCk7XG5cdFx0aW5zdGFsbExvYWRlcigpO1xuXHR9IGVsc2Uge1xuXHRcdGxvZygnbm90IGluc3RhbGxpbmcgbG9hZGVyIG1hc2sgYmVjYXVzZSBub3Qgb24gaG9tZSBwYWdlJyk7XG5cdH1cbn07XG5cbnN0YXJ0KCkuY2F0Y2goZSA9PiB7XG5cdGxvZygnZXJyb3InLCAnZmFpbGVkIHRvIHN0YXJ0IGxvYWRlcjonLCBlKTtcbn0pO1xuIl0sIm5hbWVzIjpbImlzRGVidWciLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwibG9nIiwiYXJncyIsImNvbnNvbGUiLCJlcnJvciIsInNsaWNlIiwibG9hZGVySWQiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJpbmNsdWRlcyIsImNyZWF0ZUltYWdlRXhpc3RzIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsIlByb21pc2UiLCJyZXNvbHZlIiwiY29uZGl0aW9uIiwiQm9vbGVhbiIsImRvY3VtZW50IiwiYm9keSIsIm9ic2VydmVyIiwiTXV0YXRpb25PYnNlcnZlciIsImRpc2Nvbm5lY3QiLCJvYnNlcnZlIiwiZG9jdW1lbnRFbGVtZW50IiwiY2hpbGRMaXN0Iiwic3VidHJlZSIsIm1hc2tpbmdEaXYiLCJjcmVhdGVFbGVtZW50Iiwic3R5bGUiLCJwb3NpdGlvbiIsInRvcCIsImxlZnQiLCJ3aWR0aCIsImhlaWdodCIsImJhY2tncm91bmRDb2xvciIsInpJbmRleCIsImlkIiwib3BhY2l0eSIsInJlbW92ZU1hc2tCdG4iLCJ0eXBlIiwibWFyZ2luIiwidGV4dENvbnRlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwicmVtb3ZlIiwiYXBwZW5kQ2hpbGQiLCJoZWxwVGV4dCIsImRpc3BsYXkiLCJib3JkZXIiLCJwYWRkaW5nIiwiZm9udFdlaWdodCIsImZvbnRTaXplIiwiaW5zdGFsbExvYWRlciJdLCJzb3VyY2VSb290IjoiIn0=